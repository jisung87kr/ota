# OTA Service - MVP Epics

## 개요
이 문서는 온라인 여행사(OTA) 플랫폼의 MVP(Minimum Viable Product) 개발을 위한 에픽과 유저 스토리를 정의합니다.

### MVP 목표
- 사용자가 숙박상픔을 검색하고 예약할 수 있는 기본 기능 제공
- 숙박상픔 관리자가 자신의 숙소를 등록하고 관리할 수 있는 기능 제공
- 안전한 결제 및 예약 관리 시스템 구축

---

## 🎉 구현 완료 현황 (2025-10-24 업데이트)

### ✅ 완료된 에픽 (6/6)

#### Epic 1: 사용자 인증 및 권한 관리 - ✅ 완료
- ✅ 사용자 회원가입 (이메일 인증 제외)
- ✅ 사용자 로그인/로그아웃
- ✅ 역할 기반 접근 제어 (Customer, Accommodation Manager, Admin)
- ✅ 비밀번호 재설정
- ✅ 권한별 미들웨어 및 라우트 보호

**구현 파일:**
- `app/Models/User.php` - 역할 기반 사용자 모델
- `app/Http/Controllers/Auth/AuthController.php` - 인증 컨트롤러
- `app/Http/Controllers/Auth/PasswordResetController.php` - 비밀번호 재설정
- `app/Http/Middleware/CheckRole.php` - 역할 검증 미들웨어
- `resources/views/auth/*` - 인증 관련 뷰

#### Epic 2: 숙박상픔 검색 및 조회 - ✅ 완료
- ✅ 숙박상픔 검색 기능 (목적지, 날짜, 인원)
- ✅ 검색 결과 표시 및 페이지네이션
- ✅ 필터링 (가격, 평점, 편의시설)
- ✅ 정렬 (추천순, 가격순, 평점순, 리뷰순)
- ✅ 숙박상픔 상세 정보 조회
- ✅ 객실 정보 표시

**구현 파일:**
- `app/Http/Controllers/Web/AccommodationController.php` - 숙소 검색/조회
- `app/Models/Accommodation.php` - 숙소 모델 (검색 스코프)
- `resources/views/accommodations/*` - 검색/상세 뷰

#### Epic 3: 예약 시스템 - ✅ 완료
- ✅ 객실 가용성 확인 (실시간)
- ✅ 예약 생성 - 정보 입력
- ✅ 예약 확인 페이지
- ✅ 예약 내역 조회
- ✅ 예약 상세 정보 조회
- ✅ 예약 취소 및 환불 금액 계산
- ✅ 예약 상태 관리 (Pending, Confirmed, Checked-in, Checked-out, Cancelled)

**구현 파일:**
- `app/Http/Controllers/Web/BookingController.php` - 예약 컨트롤러
- `app/Models/Booking.php` - 예약 모델 (가용성 체크, 환불 계산)
- `app/Enums/BookingStatus.php` - 예약 상태 Enum
- `resources/views/bookings/*` - 예약 관련 뷰

#### Epic 4: 숙박상픔 관리 기능 - ✅ 완료
- ✅ 숙박상픔 등록/수정/삭제
- ✅ 객실 등록/수정/삭제
- ✅ 예약 관리 - 조회 및 필터링
- ✅ 예약 상태 관리 (체크인/체크아웃 처리)
- ✅ 숙박상픔 대시보드 (주요 지표)
- ✅ 이미지 업로드 및 편의시설 관리

**구현 파일:**
- `app/Http/Controllers/Manager/AccommodationController.php` - 숙소 관리
- `app/Http/Controllers/Manager/RoomController.php` - 객실 관리
- `app/Http/Controllers/Manager/BookingManagementController.php` - 예약 관리
- `app/Http/Controllers/Manager/DashboardController.php` - 대시보드
- `resources/views/manager/*` - 관리자 뷰

#### Epic 5: 결제 시스템 - ✅ 완료
- ✅ PortOne(아임포트) PG 연동
- ✅ 신용카드 결제 처리
- ✅ 결제 성공/실패 처리
- ✅ 결제 내역 조회
- ✅ 환불 처리 (자동 환불)
- ✅ 결제 보안 (HTTPS, 토큰 기반)
- ✅ Webhook을 통한 결제 확인

**구현 파일:**
- `app/Http/Controllers/PaymentController.php` - 결제 컨트롤러
- `app/Models/Payment.php` - 결제 모델 (PG 연동 로직)
- `resources/views/payments/prepare.blade.php` - 결제 페이지
- `config/services.php` - PortOne 설정

#### Epic 6: 리뷰 시스템 - ✅ 완료
- ✅ 리뷰 작성 (체크아웃 후)
- ✅ 평점 및 항목별 평점 (청결도, 서비스, 위치, 가성비)
- ✅ 사진 업로드
- ✅ 리뷰 조회 (필터링, 정렬)
- ✅ 도움됨 기능 (좋아요)
- ✅ 숙소 측 답변
- ✅ 리뷰 관리 (숨김/표시)
- ✅ 평균 평점 및 평점 분포

**구현 파일:**
- `app/Http/Controllers/ReviewController.php` - 리뷰 컨트롤러
- `app/Models/Review.php` - 리뷰 모델
- `resources/views/reviews/create.blade.php` - 리뷰 작성
- `resources/views/accommodations/show.blade.php` - 리뷰 섹션 통합

### 📦 추가 구현 사항

#### 데이터베이스 & 시더
- ✅ 전체 데이터베이스 마이그레이션 (8개 테이블)
- ✅ AmenitySeeder - 편의시설 기본 데이터
- ✅ TestDataSeeder - 완전한 테스트 데이터
  - 14명의 사용자 (관리자 1, 매니저 3, 고객 10)
  - 6개의 숙소 (서울, 부산, 제주)
  - 각 숙소별 2-3개 객실 타입
  - 200+ 예약 데이터 (다양한 상태)
  - 결제 데이터
  - 리뷰 데이터 (숙소 답변 포함)

#### 인프라 & 개발 환경
- ✅ Docker Compose 환경 구성
  - Nginx (웹 서버)
  - PHP-FPM (Laravel)
  - MySQL 8.0
  - Redis (캐싱)
  - MongoDB (로그)
  - Node.js & npm (프론트엔드 빌드)
- ✅ Vite 개발 서버 설정
- ✅ TailwindCSS 적용

#### 코드 품질
- ✅ Enum 사용 (BookingStatus)
- ✅ 관계형 데이터 설계 (Eloquent Relationships)
- ✅ 권한 기반 라우트 보호 (Middleware)
- ✅ 입력 검증 및 에러 처리
- ✅ 한글 에러 메시지

### 🚀 실행 방법

```bash
# 1. Docker 컨테이너 시작
docker-compose up -d

# 2. 의존성 설치
docker-compose exec php composer install
docker-compose exec php npm install

# 3. 데이터베이스 초기화 및 시더 실행
docker-compose exec php php artisan migrate:fresh --seed

# 4. 프론트엔드 빌드 (개발 모드)
docker-compose exec php npm run dev

# 5. 접속
# - 웹사이트: http://localhost:9970
# - Vite HMR: http://localhost:9976
```

### 🔑 테스트 계정

| 역할 | 이메일 | 비밀번호 |
|------|--------|----------|
| 관리자 | admin@ota.com | password123 |
| 매니저 | manager1@ota.com | password123 |
| 고객 | customer1@example.com | password123 |

### 📊 구현 통계
- **총 라인 수**: 15,000+ (추정)
- **마이그레이션**: 8개
- **모델**: 10개
- **컨트롤러**: 12개
- **뷰 파일**: 40+ 개
- **라우트**: 50+ 개

### 🔄 남은 작업 (선택사항)

1. **이메일 알림** (TODO로 표시됨)
   - 예약 확인 이메일
   - 결제 완료 이메일
   - 예약 취소 이메일
   - 리뷰 작성 요청

2. **에러 페이지**
   - 403.blade.php
   - 404.blade.php
   - 500.blade.php

3. **관리자 대시보드 확장**
   - 전체 시스템 통계
   - 사용자 관리
   - 숙소 승인 시스템

4. **성능 최적화**
   - Redis 캐싱 전략
   - 이미지 최적화
   - 쿼리 최적화

5. **지도 통합**
   - Google Maps / Kakao Maps API

---

## Epic 1: 사용자 인증 및 권한 관리

### 목적
안전하고 확장 가능한 사용자 인증 시스템을 구축하여 다양한 역할(고객, 숙박상픔 관리자, 시스템 관리자)의 사용자가 플랫폼을 이용할 수 있도록 합니다.

### 비즈니스 가치
- 사용자 계정을 통한 개인화된 서비스 제공
- 역할 기반 접근 제어로 보안 강화
- 예약 이력 및 사용자 데이터 관리 기반 마련

### 우선순위
**HIGH** - 모든 기능의 기반이 되는 필수 기능

### 유저 스토리

#### US-1.1: 사용자 회원가입
**As a** 신규 방문자
**I want to** 이메일과 비밀번호로 회원가입을 할 수 있다
**So that** 숙박상픔을 예약하고 내 정보를 관리할 수 있다

**인수 기준:**
- [ ] 이메일, 비밀번호, 이름, 전화번호 입력 필드 제공
- [ ] 이메일 중복 검증
- [ ] 비밀번호 강도 검증 (최소 8자, 영문+숫자 조합)
- [ ] 이메일 인증 (선택사항 - MVP에서는 skip 가능)
- [ ] 회원가입 성공 시 자동 로그인
- [ ] 에러 메시지 표시 (중복 이메일, 약한 비밀번호 등)

**기술 스펙:**
- Laravel Validation
- bcrypt 패스워드 해싱
- CSRF 보호

---

#### US-1.2: 사용자 로그인
**As a** 등록된 사용자
**I want to** 이메일과 비밀번호로 로그인할 수 있다
**So that** 내 계정에 접근하고 서비스를 이용할 수 있다

**인수 기준:**
- [ ] 이메일, 비밀번호 입력 폼
- [ ] "로그인 상태 유지" 옵션
- [ ] 로그인 실패 시 명확한 에러 메시지
- [ ] 로그인 성공 시 대시보드/홈으로 리다이렉트
- [ ] 최대 로그인 시도 횟수 제한 (보안)

**기술 스펙:**
- Laravel Sanctum for session management
- Remember me token
- Rate limiting

---

#### US-1.3: 사용자 로그아웃
**As a** 로그인된 사용자
**I want to** 로그아웃을 할 수 있다
**So that** 내 계정의 보안을 유지할 수 있다

**인수 기준:**
- [ ] 모든 페이지에서 로그아웃 버튼 접근 가능
- [ ] 세션 완전 종료
- [ ] 로그아웃 후 로그인 페이지로 리다이렉트
- [ ] Remember me token 삭제

---

#### US-1.4: 역할 기반 접근 제어
**As a** 시스템
**I want to** 사용자의 역할에 따라 접근 권한을 제어한다
**So that** 적절한 권한을 가진 사용자만 특정 기능을 사용할 수 있다

**역할 정의:**
- **Customer (고객)**: 숙박상픔 검색, 예약, 리뷰 작성
- **Accommodation Manager (숙박상픔 관리자)**: 숙박상픔/객실 관리, 예약 관리
- **Admin (관리자)**: 전체 시스템 관리

**인수 기준:**
- [ ] 회원가입 시 기본 역할은 Customer
- [ ] 숙박상픔 관리자 등록 프로세스 (승인 필요)
- [ ] Middleware를 통한 라우트 보호
- [ ] 권한 없는 접근 시 403 페이지 표시

**기술 스펙:**
- Laravel Gate & Policy
- Role enum or database table
- Middleware: auth, role

---

#### US-1.5: 비밀번호 재설정
**As a** 비밀번호를 잊어버린 사용자
**I want to** 이메일을 통해 비밀번호를 재설정할 수 있다
**So that** 내 계정에 다시 접근할 수 있다

**인수 기준:**
- [ ] 비밀번호 재설정 요청 폼 (이메일 입력)
- [ ] 이메일로 재설정 링크 발송
- [ ] 재설정 링크 유효 시간 (1시간)
- [ ] 새 비밀번호 설정 폼
- [ ] 비밀번호 변경 완료 후 로그인 페이지로 이동

**기술 스펙:**
- Laravel Password Reset
- Email notification
- Token-based reset

---

### 종속성
없음 (기반 시스템)

### 예상 완료 기간
2-3주

---

## Epic 2: 숙박상픔 검색 및 조회

### 목적
사용자가 원하는 조건(목적지, 날짜, 인원)으로 숙박상픔을 검색하고 상세 정보를 확인할 수 있는 핵심 기능을 제공합니다.

### 비즈니스 가치
- OTA 서비스의 핵심 가치 제안
- 사용자가 원하는 숙소를 쉽게 찾을 수 있도록 지원
- 예약 전환율 향상

### 우선순위
**HIGH** - 핵심 비즈니스 기능

### 유저 스토리

#### US-2.1: 숙박상픔 검색 기능
**As a** 고객
**I want to** 목적지, 체크인/체크아웃 날짜, 인원 수로 숙박상픔을 검색할 수 있다
**So that** 내 여행 계획에 맞는 숙박상픔을 찾을 수 있다

**인수 기준:**
- [ ] 검색 바 컴포넌트 (목적지, 날짜, 인원)
- [ ] 날짜 선택기 (DatePicker) - 과거 날짜 선택 불가
- [ ] 인원 선택 (성인, 어린이)
- [ ] 검색 결과 페이지로 이동
- [ ] 검색 조건 유지 (URL 쿼리 파라미터)

**기술 스펙:**
- Vue.js SearchBar component
- Date picker library (예: Flatpickr)
- Query string handling

---

#### US-2.2: 숙박상픔 검색 결과 표시
**As a** 고객
**I want to** 검색 조건에 맞는 숙박상픔 목록을 확인할 수 있다
**So that** 여러 옵션을 비교하고 선택할 수 있다

**인수 기준:**
- [ ] 숙박상픔 카드 표시 (이미지, 이름, 위치, 평점, 최저가)
- [ ] 검색 결과 개수 표시
- [ ] 검색 조건에 맞는 가용한 숙박상픔만 표시
- [ ] 결과 없을 시 안내 메시지
- [ ] 페이지네이션 (페이지당 20개)
- [ ] 로딩 상태 표시

**기술 스펙:**
- Laravel Eloquent with eager loading
- Redis caching for performance
- AccommodationCard Vue component

---

#### US-2.3: 숙박상픔 필터링
**As a** 고객
**I want to** 가격, 평점, 편의시설로 검색 결과를 필터링할 수 있다
**So that** 내 선호도에 맞는 숙박상픔을 빠르게 찾을 수 있다

**MVP 필터 옵션:**
- [ ] 가격 범위 (슬라이더)
- [ ] 평점 (3성 이상, 4성 이상 등)
- [ ] 편의시설 (WiFi, 주차, 수영장, 조식 포함)

**인수 기준:**
- [ ] 필터 사이드바/패널
- [ ] 실시간 필터 적용 (AJAX)
- [ ] 선택된 필터 표시 및 제거
- [ ] 필터 초기화 버튼

**기술 스펙:**
- Query builder with dynamic filters
- Vue.js reactive filtering
- URL state management

---

#### US-2.4: 숙박상픔 정렬
**As a** 고객
**I want to** 검색 결과를 정렬할 수 있다
**So that** 내 기준에 맞는 순서로 숙박상픔을 볼 수 있다

**정렬 옵션:**
- [ ] 추천순 (기본)
- [ ] 낮은 가격순
- [ ] 높은 가격순
- [ ] 평점 높은 순
- [ ] 리뷰 많은 순

**인수 기준:**
- [ ] 정렬 드롭다운
- [ ] 정렬 변경 시 즉시 반영
- [ ] 선택된 정렬 옵션 표시

---

#### US-2.5: 숙박상픔 상세 정보 조회
**As a** 고객
**I want to** 숙박상픔의 상세 정보를 확인할 수 있다
**So that** 예약 전에 충분한 정보를 얻을 수 있다

**표시 정보:**
- [ ] 숙박상픔 기본 정보 (이름, 주소, 연락처)
- [ ] 이미지 갤러리
- [ ] 설명 및 특징
- [ ] 편의시설 목록
- [ ] 위치 지도 (Google Maps 또는 Naver Maps)
- [ ] 평점 및 리뷰 요약
- [ ] 이용 가능한 객실 목록

**인수 기준:**
- [ ] 반응형 레이아웃
- [ ] 이미지 라이트박스
- [ ] 스크롤 네비게이션 (객실, 편의시설, 위치, 리뷰)
- [ ] 예약하기 버튼 (객실별)

**기술 스펙:**
- Blade template with Vue components
- Image optimization
- Google Maps API or Kakao/Naver Maps

---

#### US-2.6: 객실 정보 표시
**As a** 고객
**I want to** 숙박상픔 상세 페이지에서 객실 정보를 확인할 수 있다
**So that** 내 필요에 맞는 객실을 선택할 수 있다

**표시 정보:**
- [ ] 객실 타입 (스탠다드, 디럭스 등)
- [ ] 객실 이미지
- [ ] 최대 수용 인원
- [ ] 객실 크기
- [ ] 침대 타입
- [ ] 객실 편의시설
- [ ] 가격 (1박 기준)
- [ ] 가용 객실 수

**인수 기준:**
- [ ] 객실 카드 레이아웃
- [ ] 검색한 날짜 기준 가용성 표시
- [ ] 가격은 총액과 1박 기준 표시
- [ ] "예약하기" 버튼

---

### 종속성
- Epic 1 (사용자 인증) - 로그인 상태에서 더 많은 정보 제공 가능

### 예상 완료 기간
3-4주

---

## Epic 3: 예약 시스템

### 목적
고객이 원하는 숙박상픔 객실을 선택하고 예약할 수 있으며, 예약 내역을 관리할 수 있는 시스템을 구축합니다.

### 비즈니스 가치
- 핵심 수익 창출 기능
- 고객 전환율 극대화
- 예약 데이터를 통한 비즈니스 인사이트 확보

### 우선순위
**HIGH** - 핵심 수익 창출 기능

### 유저 스토리

#### US-3.1: 객실 가용성 확인
**As a** 고객
**I want to** 특정 날짜에 객실이 예약 가능한지 확인할 수 있다
**So that** 예약 가능한 객실만 선택할 수 있다

**인수 기준:**
- [ ] 실시간 가용성 체크
- [ ] 날짜 범위별 가용 객실 수 표시
- [ ] 예약 불가능한 객실은 비활성화 표시
- [ ] 가용성 변경 시 자동 업데이트

**기술 스펙:**
- Database query optimization
- Inventory management logic
- AJAX real-time check

---

#### US-3.2: 예약 생성 - 정보 입력
**As a** 고객
**I want to** 예약에 필요한 정보를 입력할 수 있다
**So that** 숙박상픔 측에 내 정보를 제공하고 예약을 확정할 수 있다

**필수 입력 정보:**
- [ ] 투숙객 이름
- [ ] 연락처 (전화번호)
- [ ] 이메일
- [ ] 특별 요청사항 (선택)

**인수 기준:**
- [ ] 예약 폼 (step 1)
- [ ] 로그인된 사용자의 경우 자동 입력
- [ ] 입력 검증
- [ ] 예약 요약 정보 표시 (숙박상픔명, 객실, 날짜, 금액)

**기술 스펙:**
- Vue.js multi-step form
- Form validation
- Auto-fill for logged-in users

---

#### US-3.3: 예약 생성 - 결제
**As a** 고객
**I want to** 예약 금액을 결제할 수 있다
**So that** 예약을 확정할 수 있다

**인수 기준:**
- [ ] 결제 방법 선택 (신용카드, 무통장입금 등)
- [ ] 총 결제 금액 표시 (상세 내역 포함)
- [ ] 취소 정책 표시 및 동의
- [ ] 이용약관 동의 체크박스
- [ ] 결제 처리 (Epic 5 참조)
- [ ] 결제 실패 시 에러 처리

**기술 스펙:**
- Payment gateway integration (PortOne, Stripe 등)
- Transaction management
- PCI-DSS compliance considerations

---

#### US-3.4: 예약 확인
**As a** 고객
**I want to** 예약이 완료되면 확인 페이지와 이메일을 받을 수 있다
**So that** 예약 정보를 확인하고 보관할 수 있다

**인수 기준:**
- [ ] 예약 완료 페이지 (예약 번호, 상세 정보)
- [ ] 예약 확인 이메일 발송
- [ ] 예약 내역 페이지로 이동 링크
- [ ] PDF 다운로드 옵션 (선택사항)

**이메일 내용:**
- [ ] 예약 번호
- [ ] 숙박상픔 정보
- [ ] 체크인/체크아웃 날짜
- [ ] 투숙객 정보
- [ ] 총 금액
- [ ] 취소 정책

**기술 스펙:**
- Laravel Mail
- Queue for async email sending
- Email template

---

#### US-3.5: 예약 내역 조회
**As a** 고객
**I want to** 내 예약 내역을 확인할 수 있다
**So that** 예약 상태를 추적하고 관리할 수 있다

**인수 기준:**
- [ ] 예약 목록 페이지
- [ ] 예약 상태별 필터 (전체, 예정, 완료, 취소)
- [ ] 각 예약의 요약 정보 표시
- [ ] 예약 상세 페이지로 이동
- [ ] 최신 예약 우선 정렬

**예약 상태:**
- Pending (결제 대기)
- Confirmed (예약 확정)
- Checked-in (체크인 완료)
- Checked-out (체크아웃 완료)
- Cancelled (취소됨)

**기술 스펙:**
- User dashboard
- Eloquent relationships
- Status filtering

---

#### US-3.6: 예약 상세 정보 조회
**As a** 고객
**I want to** 특정 예약의 상세 정보를 확인할 수 있다
**So that** 예약 내용을 자세히 파악할 수 있다

**표시 정보:**
- [ ] 예약 번호 및 상태
- [ ] 숙박상픔 정보
- [ ] 객실 정보
- [ ] 체크인/체크아웃 날짜
- [ ] 투숙객 정보
- [ ] 결제 정보
- [ ] 특별 요청사항
- [ ] 취소 정책

**액션 버튼:**
- [ ] 예약 취소 (조건부)
- [ ] 영수증 다운로드
- [ ] 고객센터 문의

---

#### US-3.7: 예약 취소
**As a** 고객
**I want to** 예약을 취소할 수 있다
**So that** 계획 변경 시 대응할 수 있다

**인수 기준:**
- [ ] 취소 가능 여부 확인 (날짜, 취소 정책)
- [ ] 취소 시 환불 금액 표시
- [ ] 취소 사유 입력 (선택)
- [ ] 취소 확인 모달
- [ ] 취소 완료 후 상태 업데이트
- [ ] 취소 확인 이메일 발송

**취소 정책 (MVP):**
- 체크인 7일 전: 100% 환불
- 체크인 3-7일 전: 50% 환불
- 체크인 3일 이내: 환불 불가

**기술 스펙:**
- Cancellation policy engine
- Refund calculation logic
- Status transition management

---

### 종속성
- Epic 1 (사용자 인증) - 필수
- Epic 2 (숙박상픔 검색) - 필수
- Epic 5 (결제 시스템) - 필수

### 예상 완료 기간
4-5주

---

## Epic 4: 숙박상픔 관리 기능

### 목적
숙박상픔 관리자가 자신의 숙소를 등록하고 객실을 관리하며 예약을 확인할 수 있는 관리 시스템을 제공합니다.

### 비즈니스 가치
- 숙박상픔 파트너 유치 및 유지
- 플랫폼 콘텐츠 확보 (공급)
- 파트너 만족도 향상

### 우선순위
**MEDIUM** - MVP에서는 기본 기능만 제공

### 유저 스토리

#### US-4.1: 숙박상픔 관리자 등록
**As a** 숙박상픔 소유자
**I want to** 숙박상픔 관리자 계정을 신청할 수 있다
**So that** 내 숙박상픔을 플랫폼에 등록할 수 있다

**인수 기준:**
- [ ] 숙박상픔 관리자 신청 폼
- [ ] 사업자 정보 입력 (사업자명, 사업자등록번호)
- [ ] 담당자 정보 입력
- [ ] 관리자 승인 대기 상태
- [ ] 승인 완료 시 이메일 알림

**기술 스펙:**
- Admin approval workflow
- Role assignment
- Notification system

---

#### US-4.2: 숙박상픔 등록
**As a** 숙박상픔 관리자
**I want to** 내 숙박상픔의 기본 정보를 등록할 수 있다
**So that** 고객들이 내 숙박상픔을 찾고 예약할 수 있다

**필수 정보:**
- [ ] 숙박상픔 이름
- [ ] 카테고리 (숙박상픔, 모텔, 리조트, 게스트하우스 등)
- [ ] 주소
- [ ] 연락처
- [ ] 설명
- [ ] 메인 이미지 (최소 1개, 최대 10개)
- [ ] 편의시설 선택

**인수 기준:**
- [ ] 숙박상픔 등록 폼
- [ ] 이미지 업로드 (drag & drop)
- [ ] 주소 검색 기능 (Kakao/Naver API)
- [ ] 편의시설 체크박스 리스트
- [ ] 미리보기 기능
- [ ] 등록 후 대시보드로 이동

**기술 스펙:**
- File upload handling
- Image optimization
- Geocoding for address

---

#### US-4.3: 숙박상픔 정보 수정
**As a** 숙박상픔 관리자
**I want to** 등록한 숙박상픔 정보를 수정할 수 있다
**So that** 정보를 최신으로 유지할 수 있다

**인수 기준:**
- [ ] 숙박상픔 정보 수정 페이지
- [ ] 기존 정보 자동 로드
- [ ] 이미지 추가/삭제
- [ ] 변경사항 저장
- [ ] 변경 이력 기록 (audit log - 선택사항)

---

#### US-4.4: 객실 등록
**As a** 숙박상픔 관리자
**I want to** 내 숙박상픔의 객실을 등록할 수 있다
**So that** 고객들이 객실을 예약할 수 있다

**필수 정보:**
- [ ] 객실 타입 이름
- [ ] 객실 설명
- [ ] 최대 수용 인원
- [ ] 침대 타입 및 개수
- [ ] 객실 크기 (㎡)
- [ ] 객실 이미지
- [ ] 기본 가격 (1박)
- [ ] 총 객실 수

**인수 기준:**
- [ ] 객실 등록 폼
- [ ] 여러 객실 타입 등록 가능
- [ ] 객실 편의시설 선택
- [ ] 이미지 업로드
- [ ] 가격 설정 (기본 가격)

**기술 스펙:**
- Room inventory management
- Image gallery
- Pricing logic

---

#### US-4.5: 객실 정보 수정
**As a** 숙박상픔 관리자
**I want to** 등록한 객실 정보를 수정할 수 있다
**So that** 객실 정보를 최신으로 유지할 수 있다

**인수 기준:**
- [ ] 객실 목록 조회
- [ ] 객실 정보 수정 페이지
- [ ] 기존 정보 로드
- [ ] 변경사항 저장

---

#### US-4.6: 예약 관리 - 조회
**As a** 숙박상픔 관리자
**I want to** 내 숙박상픔의 예약 내역을 확인할 수 있다
**So that** 예약 현황을 파악하고 관리할 수 있다

**인수 기준:**
- [ ] 예약 목록 페이지
- [ ] 날짜별 필터 (오늘, 이번 주, 이번 달)
- [ ] 상태별 필터
- [ ] 객실별 필터
- [ ] 예약 상세 정보 조회
- [ ] 검색 기능 (예약 번호, 고객명)

**표시 정보:**
- [ ] 예약 번호
- [ ] 고객명
- [ ] 객실 타입
- [ ] 체크인/체크아웃 날짜
- [ ] 예약 상태
- [ ] 총 금액

---

#### US-4.7: 예약 상태 관리
**As a** 숙박상픔 관리자
**I want to** 예약 상태를 업데이트할 수 있다
**So that** 예약 진행 상황을 관리할 수 있다

**가능한 액션:**
- [ ] 예약 확인 (Pending → Confirmed)
- [ ] 체크인 처리 (Confirmed → Checked-in)
- [ ] 체크아웃 처리 (Checked-in → Checked-out)
- [ ] 예약 취소 (특별한 경우)

**인수 기준:**
- [ ] 상태 변경 버튼
- [ ] 상태 변경 확인 모달
- [ ] 메모 입력 옵션
- [ ] 상태 변경 이력 기록
- [ ] 고객에게 알림 발송 (이메일)

---

#### US-4.8: 숙박상픔 대시보드
**As a** 숙박상픔 관리자
**I want to** 한눈에 숙박상픔 운영 현황을 확인할 수 있다
**So that** 비즈니스 상황을 빠르게 파악할 수 있다

**표시 정보:**
- [ ] 오늘 체크인 예정 수
- [ ] 오늘 체크아웃 예정 수
- [ ] 이번 달 예약 수
- [ ] 이번 달 매출
- [ ] 최근 예약 목록
- [ ] 객실 가동률

**인수 기준:**
- [ ] 대시보드 페이지
- [ ] 주요 지표 카드
- [ ] 간단한 차트 (선택사항 - MVP에서는 skip 가능)
- [ ] Quick action 버튼

---

### 종속성
- Epic 1 (사용자 인증) - 필수
- Epic 3 (예약 시스템) - 예약 관리 기능

### 예상 완료 기간
3-4주

---

## Epic 5: 결제 시스템

### 목적
안전하고 신뢰할 수 있는 결제 처리 시스템을 구축하여 예약 거래를 완료할 수 있도록 합니다.

### 비즈니스 가치
- 수익 창출의 핵심 인프라
- 고객 신뢰 확보
- 결제 데이터 추적 및 관리

### 우선순위
**HIGH** - 수익 창출 필수 기능

### 유저 스토리

#### US-5.1: 결제 수단 선택
**As a** 고객
**I want to** 다양한 결제 수단 중에서 선택할 수 있다
**So that** 내가 선호하는 방법으로 결제할 수 있다

**MVP 결제 수단:**
- [ ] 신용카드/체크카드
- [ ] 무통장입금 (선택사항)

**인수 기준:**
- [ ] 결제 수단 선택 UI
- [ ] 선택한 결제 수단에 따른 입력 폼 표시
- [ ] 보안 표시 (SSL, 암호화 안내)

**기술 스펙:**
- PG사 연동 (PortOne, Toss Payments 등 추천)
- PCI-DSS compliance
- HTTPS 필수

---

#### US-5.2: 신용카드 결제 처리
**As a** 고객
**I want to** 신용카드로 안전하게 결제할 수 있다
**So that** 예약을 즉시 확정할 수 있다

**인수 기준:**
- [ ] PG사 결제 모듈 연동
- [ ] 결제 금액 확인
- [ ] 결제 처리 로딩 표시
- [ ] 결제 성공/실패 처리
- [ ] 트랜잭션 로그 기록

**결제 플로우:**
1. 고객이 결제 버튼 클릭
2. PG사 결제창 오픈
3. 카드 정보 입력 (PG사 페이지)
4. 결제 승인 처리
5. 결제 결과 수신
6. 예약 상태 업데이트
7. 결제 확인 페이지로 이동

**기술 스펙:**
- PortOne (구 아임포트) SDK
- Webhook for payment confirmation
- Transaction table

---

#### US-5.3: 결제 실패 처리
**As a** 시스템
**I want to** 결제 실패 시 적절하게 처리한다
**So that** 고객이 재시도하거나 다른 방법을 선택할 수 있다

**인수 기준:**
- [ ] 실패 사유 표시
- [ ] 재시도 버튼
- [ ] 다른 결제 수단 선택 옵션
- [ ] 고객 지원 연락처 표시
- [ ] 실패 로그 기록

**주요 실패 케이스:**
- 카드 한도 초과
- 유효하지 않은 카드
- 네트워크 오류
- 시스템 오류

---

#### US-5.4: 결제 내역 조회
**As a** 고객
**I want to** 내 결제 내역을 확인할 수 있다
**So that** 지출을 추적하고 관리할 수 있다

**인수 기준:**
- [ ] 결제 내역 목록 페이지
- [ ] 결제 상세 정보 (예약 정보, 결제 수단, 금액, 날짜)
- [ ] 영수증 다운로드/출력
- [ ] 날짜 범위 필터

**표시 정보:**
- [ ] 거래 번호
- [ ] 예약 번호
- [ ] 숙박상픔명
- [ ] 결제 수단
- [ ] 결제 금액
- [ ] 결제 일시
- [ ] 결제 상태

---

#### US-5.5: 환불 처리
**As a** 고객
**I want to** 예약 취소 시 자동으로 환불받을 수 있다
**So that** 취소 정책에 따라 환불을 받을 수 있다

**인수 기준:**
- [ ] 취소 정책 기반 환불 금액 계산
- [ ] 자동 환불 처리 (PG사 API)
- [ ] 환불 상태 추적
- [ ] 환불 완료 알림
- [ ] 수동 환불 옵션 (관리자)

**환불 상태:**
- Pending (환불 요청됨)
- Processing (환불 처리 중)
- Completed (환불 완료)
- Failed (환불 실패)

**기술 스펙:**
- PG refund API
- Refund calculation logic
- Queue for async processing

---

#### US-5.6: 결제 보안
**As a** 시스템
**I want to** 결제 정보를 안전하게 처리한다
**So that** 고객의 금융 정보를 보호할 수 있다

**보안 요구사항:**
- [ ] HTTPS 통신 (SSL/TLS)
- [ ] 카드 정보는 PG사에서만 처리 (no storage)
- [ ] 결제 토큰만 저장
- [ ] 중복 결제 방지
- [ ] Rate limiting
- [ ] Fraud detection (기본)

**인수 기준:**
- [ ] SSL 인증서 적용
- [ ] PG사 인증 구현
- [ ] 결제 요청 검증
- [ ] 중복 거래 방지 로직
- [ ] 민감 정보 로깅 금지

---

### 종속성
- Epic 3 (예약 시스템) - 필수

### 예상 완료 기간
2-3주

### 기술 선택 고려사항
**추천 PG사:**
- **PortOne (아임포트)**: 국내 다양한 PG사 통합, 개발자 친화적
- **Toss Payments**: 간편한 연동, 좋은 UX
- **Stripe**: 글로벌 서비스 시 고려

---

## Epic 6: 리뷰 시스템 (MVP 선택사항)

### 목적
고객이 숙박 후 리뷰를 작성하고 다른 고객들이 리뷰를 참고할 수 있는 시스템을 제공합니다.

### 비즈니스 가치
- 고객 신뢰도 향상
- 숙박상픔 품질 피드백
- 플랫폼 콘텐츠 풍부화

### 우선순위
**LOW** - MVP에서는 선택적 구현 (Phase 2로 미룰 수 있음)

### 유저 스토리

#### US-6.1: 리뷰 작성
**As a** 체크아웃을 완료한 고객
**I want to** 숙박했던 숙박상픔에 대한 리뷰를 작성할 수 있다
**So that** 내 경험을 다른 고객들과 공유할 수 있다

**인수 기준:**
- [ ] 체크아웃 완료 후 리뷰 작성 권한 부여
- [ ] 평점 (1-5점)
- [ ] 리뷰 제목
- [ ] 리뷰 내용 (최소 20자)
- [ ] 선택적 항목별 평점 (청결도, 서비스, 위치, 가성비)
- [ ] 사진 업로드 (선택)
- [ ] 중복 리뷰 방지 (1예약 1리뷰)

---

#### US-6.2: 리뷰 조회
**As a** 고객
**I want to** 숙박상픔의 리뷰를 확인할 수 있다
**So that** 예약 결정에 참고할 수 있다

**인수 기준:**
- [ ] 숙박상픔 상세 페이지에 리뷰 섹션
- [ ] 평균 평점 및 리뷰 개수
- [ ] 리뷰 목록 (페이지네이션)
- [ ] 평점별 필터
- [ ] 최신순/평점순 정렬
- [ ] 도움이 됨 기능 (좋아요)

---

#### US-6.3: 리뷰 관리 (관리자)
**As a** 관리자
**I want to** 부적절한 리뷰를 관리할 수 있다
**So that** 플랫폼의 품질을 유지할 수 있다

**인수 기준:**
- [ ] 신고된 리뷰 확인
- [ ] 리뷰 숨김/삭제
- [ ] 작성자에게 알림

---

### 종속성
- Epic 3 (예약 시스템) - 필수

### 예상 완료 기간
2주

---

## 개발 우선순위 및 로드맵

### Phase 1: Core MVP (8-10주)
**목표: 기본적인 예약 플로우 완성**

1. **Week 1-3**: Epic 1 - 사용자 인증 및 권한 관리
2. **Week 3-6**: Epic 2 - 숙박상픔 검색 및 조회
3. **Week 6-8**: Epic 5 - 결제 시스템
4. **Week 6-10**: Epic 3 - 예약 시스템
5. **Week 8-10**: Epic 4 - 숙박상픔 관리 기능 (기본)

### Phase 2: Enhancement (4-6주)
**목표: 사용자 경험 개선 및 추가 기능**

- Epic 6 - 리뷰 시스템
- 고급 검색 필터
- 알림 시스템
- 모바일 최적화

### Phase 3: Scale & Optimize (지속)
**목표: 성능 최적화 및 확장**

- 캐싱 전략
- 이미지 최적화
- 검색 성능 개선
- 분석 및 모니터링

---

## 기술 스택 요약

### 백엔드
- Laravel 11
- MySQL (주요 DB)
- Redis (캐싱, 세션)
- MongoDB (로그) - 선택사항

### 프론트엔드
- Blade Templates
- Vue.js 3
- TailwindCSS
- Vite

### 결제
- PortOne (아임포트) 또는 Toss Payments

### 인프라
- Docker & Docker Compose
- Nginx

### 기타
- Git & GitHub
- Laravel Sanctum (인증)
- Laravel Queue (비동기 작업)
- Laravel Mail (이메일)

---

## 성공 지표 (KPIs)

### MVP 단계 성공 기준
- [ ] 사용자가 회원가입부터 예약 완료까지 전체 플로우를 완료할 수 있다
- [ ] 숙박상픔 관리자가 숙박상픔과 객실을 등록하고 예약을 관리할 수 있다
- [ ] 결제가 안전하게 처리된다
- [ ] 반응 시간 < 2초 (주요 페이지)
- [ ] 모바일 반응형 지원

### 비즈니스 지표 (런칭 후)
- 주간 활성 사용자 (WAU)
- 예약 전환율 (검색 → 예약)
- 평균 예약 금액
- 숙박상픔 파트너 수
- 고객 만족도

---

## 리스크 및 대응 방안

### 기술적 리스크
1. **결제 시스템 장애**
   - 대응: 여러 PG사 백업, 철저한 테스트

2. **동시성 문제 (객실 재고)**
   - 대응: Database lock, Redis를 이용한 재고 관리

3. **성능 이슈**
   - 대응: 캐싱 전략, 쿼리 최적화, CDN

### 비즈니스 리스크
1. **숙박상픔 파트너 부족**
   - 대응: 초기 파트너 모집 인센티브

2. **경쟁사 대비 차별화 부족**
   - 대응: 특화된 기능 개발, 틈새 시장 공략

---

## 다음 단계

1. **에픽 승인**: 이해관계자와 에픽 검토 및 승인
2. **상세 설계**: 각 에픽에 대한 기술 설계 문서 작성
3. **Sprint 계획**: 유저 스토리를 Sprint로 분할
4. **개발 환경 구축**: Docker, CI/CD 설정
5. **개발 시작**: Phase 1 Epic 1부터 시작

---

## 부록

### 용어 정리
- **OTA**: Online Travel Agency (온라인 여행사)
- **PG**: Payment Gateway (결제 대행사)
- **MVP**: Minimum Viable Product (최소 기능 제품)
- **Epic**: 큰 단위의 작업 묶음
- **User Story**: 사용자 관점의 기능 요구사항

### 참고 자료
- Laravel Documentation: https://laravel.com/docs
- Vue.js Documentation: https://vuejs.org
- PortOne Documentation: https://portone.io/korea/ko/docs
- TailwindCSS Documentation: https://tailwindcss.com/docs

---

**문서 버전**: 1.0
**작성일**: 2025-10-24
**최종 수정일**: 2025-10-24
**작성자**: Development Team
